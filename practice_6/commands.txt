# запуск minikube 

minikube start
minikube docker-env
@FOR /f "tokens=*" %i IN ('minikube -p minikube docker-env --shell cmd') DO @%i

kubectl create configmap frontend-config --from-literal=journalEntries=10
kubectl create secret generic redis-passwd --from-literal=passwd=${RANDOM}
kubectl create configmap redis-config --from-file=launch.sh=launch.sh

docker build -t journal-server .
docker run --name journal-server journal-server

docker build -t static-files .
docker run --name static-files static-files

kubectl create namespace savinov-ikbo-16-20

kubectl apply -f fileserver/fileserver.yaml --namespace=savinov-ikbo-16-20
kubectl apply -f frontend/frontend-with-secret.yaml --namespace=savinov-ikbo-16-20
kubectl apply -f redis/redis.yaml --namespace=savinov-ikbo-16-20

kubectl apply -f fileserver/fileserver-service.yaml --namespace=savinov-ikbo-16-20
kubectl apply -f frontend/frontend-service.yaml --namespace=savinov-ikbo-16-20
kubectl apply -f redis/redis-service.yaml --namespace=savinov-ikbo-16-20

